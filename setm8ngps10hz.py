#!/usr/bin/python

from serial import Serial
import time
#This script is for configuring UBLOX chipset GPS units.

def main():
    try:
        serialPort = Serial("/dev/ttyUSB2",9600,timeout =2)  #set initial baud rate
        if (serialPort.isOpen() == False):
            serialPort.open()
        #msg = [0xb5, 0x62, 0x06, 0x08, 0x06 0x00, 0x64, 0x00, 0x01, 0x00, 0x01, 0x00, 0x7A, 0x12]
        #baud rate message 115200 not necessary but good to do with usb interface
        #print("GPS set to 115200")
        #msg = bytearray([0xB5,0x62, 0x06, 0x00, 0x14, 0x00, 0x01, 0x00, 0x00, 0x00, 0xD0, 0x08, 0x00, 0x00, 0x00, 0xC2, 0x01, 0x00, 0x07, 0x00, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0xC0, 0x7E])
        #serialPort.write(msg)
        print ('GPS set to 230400')
        msg = bytearray([0xB5,0x62, 0x06, 0x00, 0x14, 0x00, 0x01, 0x00, 0x00, 0x00, 0xD0, 0x08, 0x00, 0x00, 0x00, 0x84, 0x03, 0x00, 0x07, 0x00, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x84, 0xE8])
        serialPort.write(msg)
    

        time.sleep(.5)
        serialPort = Serial("/dev/ttyUSB2",230400,timeout =2)  #set initial baud rate
 
    
        #10hz message
        msg = bytearray([0xb5, 0x62, 0x06, 0x08, 0x06, 0x00, 0x64, 0x00, 0x01, 0x00, 0x01, 0x00, 0x7A, 0x12])
        serialPort.write(msg)
        time.sleep(.5)
        print("GPS set to 10hz")

    except:
        print("Error writing config string to gps. No gps found?")
    
#### set baud rate higher  ###
    #serialPort.flushInput()
    time.sleep(.5)
if __name__ == "__main__":
    main()

